<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./">Project Page</a>
      <a href="./indexpage.html">Index</a>
      <a href="./toc.html">Table of Contents</a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">Friendship.adj2_matrix</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">ssreflect</span> <span class="id" title="library">ssrfun</span> <span class="id" title="library">ssrbool</span> <span class="id" title="library">eqtype</span> <span class="id" title="library">ssrnat</span> <span class="id" title="library">ssrint</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">fintype</span> <span class="comment">(*tuple&nbsp;*)</span> <span class="id" title="library">finfun</span> <span class="id" title="library">bigop</span>  <span class="comment">(*fingroup&nbsp;perm*)</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">ssralg</span> <span class="id" title="library">zmodp</span> <span class="id" title="library">matrix</span> <span class="id" title="library">mxalgebra</span> <span class="id" title="library">poly</span> <span class="comment">(*&nbsp;polydiv&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="library">mxpoly</span>.<br/>

<br/>
<span class="comment">(*<br/>
Only&nbsp;works&nbsp;with&nbsp;pure&nbsp;ring&nbsp;expressions,&nbsp;and&nbsp;I&nbsp;couldn't&nbsp;find&nbsp;any&nbsp;in&nbsp;this&nbsp;proof.<br/>
Maybe&nbsp;it&nbsp;would&nbsp;work&nbsp;with&nbsp;"generalize&nbsp;&lt;expr&gt;;&nbsp;field"?&nbsp;TODO:&nbsp;try&nbsp;that.<br/>
From&nbsp;mathcomp.algebra_tactics&nbsp;Require&nbsp;Import&nbsp;ring&nbsp;.<br/>
&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">algC</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.micromega.Lia.html#"><span class="id" title="library">Lia</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Hammer</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Tactics</span> .<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Friendship.square_char_poly.html#"><span class="id" title="library">Friendship.square_char_poly</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Friendship.matrix_lemmas.html#"><span class="id" title="library">Friendship.matrix_lemmas</span></a>.<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">Unset</span> <span class="id" title="keyword">Strict</span> <span class="id" title="keyword">Implicit</span>.<br/>
<span class="id" title="keyword">Unset</span> <span class="id" title="keyword">Printing</span> <span class="id" title="keyword">Implicit</span> <span class="id" title="var">Defensive</span>.<br/>

<br/>
<span class="comment">(*Import&nbsp;GroupScope.*)</span><br/>
<span class="id" title="keyword">Import</span> <span class="id" title="module">GRing.Theory</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">ring_scope</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">tuple</span> <span class="id" title="library">seq</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">ssrnat_lia</span> := <span class="id" title="tactic">rewrite</span> /<span class="id" title="definition">leq</span> /<span class="id" title="definition">subn</span> /<span class="id" title="definition">subn_rec</span> /<span class="id" title="definition">addn</span> /<span class="id" title="definition">addn_rec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/<span class="id" title="definition">muln</span> /<span class="id" title="definition">muln_rec</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Section</span> <a id="adj2_matrix_props" class="idref" href="#adj2_matrix_props"><span class="id" title="section">adj2_matrix_props</span></a>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="R" class="idref" href="#R"><span class="id" title="definition">R</span></a> := <span class="id" title="abbreviation">algC</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="n:1" class="idref" href="#n:1"><span class="id" title="binder">n</span></a> <a id="k:2" class="idref" href="#k:2"><span class="id" title="binder">k</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="kge1:3" class="idref" href="#kge1:3"><span class="id" title="binder">kge1</span></a>: (<a class="idref" href="Friendship.adj2_matrix.html#k:2"><span class="id" title="variable">k</span></a> <span class="id" title="notation">&gt;=</span>1) %<span class="id" title="var">N</span>) (<a id="nge1:4" class="idref" href="#nge1:4"><span class="id" title="binder">nge1</span></a>: (<a class="idref" href="Friendship.adj2_matrix.html#n:1"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;=</span> 1) %<span class="id" title="var">N</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="matN" class="idref" href="#matN"><span class="id" title="definition">matN</span></a> := <span class="id" title="notation">'</span><span class="id" title="notation">M</span><span class="id" title="notation">[</span><a class="idref" href="Friendship.adj2_matrix.html#R"><span class="id" title="definition">R</span></a><span class="id" title="notation">]</span><span class="id" title="notation">_</span><span class="id" title="notation">(</span>1%<span class="id" title="var">N</span> <span class="id" title="notation">+</span> (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1)%<span class="id" title="var">N</span><span class="id" title="notation">)</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="P" class="idref" href="#P"><span class="id" title="definition">P</span></a> : <a class="idref" href="Friendship.adj2_matrix.html#matN"><span class="id" title="definition">matN</span></a> := (@<span class="id" title="definition">block_mx</span> <span class="id" title="var">_</span> 1 (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1)%<span class="id" title="var">N</span> 1 (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1)%<span class="id" title="var">N</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">const_mx</span> 1)  (<span class="id" title="definition">const_mx</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">const_mx</span> 1) (<span class="id" title="notation">(</span>-1<span class="id" title="notation">)%:</span><span class="id" title="notation">M</span>)).<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof&nbsp;by&nbsp;computation;&nbsp;Use&nbsp;the&nbsp;block&nbsp;determinant&nbsp;formula&nbsp;to&nbsp;show<br/>
&nbsp;&nbsp;&nbsp;that&nbsp;the&nbsp;determinant&nbsp;is&nbsp;Â±n,&nbsp;and&nbsp;then&nbsp;use&nbsp;the&nbsp;field&nbsp;characteristic<br/>
&nbsp;&nbsp;&nbsp;assumption&nbsp;to&nbsp;show&nbsp;that&nbsp;it's&nbsp;not&nbsp;zero.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="P_unit" class="idref" href="#P_unit"><span class="id" title="lemma">P_unit</span></a> : <a class="idref" href="Friendship.adj2_matrix.html#P"><span class="id" title="definition">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="definition">unitmx</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">neg1M_det</span> <span class="id" title="var">m</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">\</span><span class="id" title="notation">det</span> <span class="id" title="notation">(</span><span class="id" title="notation">(</span>-1<span class="id" title="notation">)%:</span><span class="id" title="notation">M</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <span class="id" title="notation">'</span><span class="id" title="notation">M</span><span class="id" title="notation">[</span><a class="idref" href="Friendship.adj2_matrix.html#R"><span class="id" title="definition">R</span></a><span class="id" title="notation">]</span><span class="id" title="notation">_m</span><span class="id" title="notation">)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">(</span>-1<span class="id" title="notation">)</span> <span class="id" title="notation">^+</span> <span class="id" title="notation">(</span><span class="id" title="definition">odd</span> <a class="idref" href="Friendship.adj2_matrix.html#m:5"><span class="id" title="variable">m</span></a><span class="id" title="notation">)</span> <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">det_scalar</span> -[<span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS"><span class="id" title="abbreviation">LHS</span></a>]<span class="id" title="definition">signr_odd</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">neg1M_unit</span> <span class="id" title="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">(</span></a><span class="id" title="notation">(</span>-1<span class="id" title="notation">)%:</span><span class="id" title="notation">M</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <span class="id" title="notation">'</span><span class="id" title="notation">M</span><span class="id" title="notation">[</span><a class="idref" href="Friendship.adj2_matrix.html#R"><span class="id" title="definition">R</span></a><span class="id" title="notation">]</span><span class="id" title="notation">_m</span><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="definition">unitmx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">unitmxE</span> <span class="id" title="var">neg1M_det</span>; <span class="id" title="tactic">case</span>: (<span class="id" title="definition">odd</span> <span class="id" title="var">m</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<span class="id" title="definition">expr1</span> ?<span class="id" title="definition">expr0</span> ?<span class="id" title="definition">unitrN1</span> ?<span class="id" title="definition">unitr1</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">unitmxE</span>  <a class="idref" href="Friendship.matrix_lemmas.html#det_block"><span class="id" title="lemma">det_block</span></a> // <span class="id" title="var">neg1M_det</span> (<span class="id" title="lemma">pinvmxE</span> (<span class="id" title="var">neg1M_unit</span> <span class="id" title="var">_</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="lemma">invmx_scalar</span> <span class="id" title="lemma">det_mx11</span>  <span class="id" title="definition">invrN1</span>  <span class="id" title="lemma">scalar_mxC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-<span class="id" title="lemma">mulmxA</span> <a class="idref" href="Friendship.matrix_lemmas.html#dotmul"><span class="id" title="lemma">dotmul</span></a>  <span class="id" title="lemma">mul_scalar_mx</span> <span class="id" title="lemma">scalemx_const</span>  !<span class="id" title="lemma">mxE</span> <span class="id" title="definition">mulN1r</span> <span class="id" title="definition">opprK</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-{2}(<span class="id" title="definition">mulr1n</span> 1) -<span class="id" title="definition">mulrnDr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.nge1"><span class="id" title="variable">nge1</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> =&gt; [<span class="id" title="var">_</span>|<span class="id" title="var">n'</span> <span class="id" title="var">_</span>] //= ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subSS</span>  /<span class="id" title="definition">subn</span> /<span class="id" title="definition">subn_rec</span>  <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_0_r"><span class="id" title="lemma">PeanoNat.Nat.sub_0_r</span></a>  <span class="id" title="definition">unitfE</span> .<br/>

<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span> <span class="id" title="var">aou</span>: <span class="id" title="notation">(</span>@<span class="id" title="definition">GRing.natmul</span> (<span class="id" title="abbreviation">ZmodType</span> <span class="id" title="abbreviation">algC</span> <span class="id" title="var">_</span> ) 1 (1 <span class="id" title="notation">+</span> <span class="id" title="var">n'</span>)<span class="id" title="notation">)</span> <span class="id" title="notation">!=</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: (<span class="id" title="definition">odd</span> <span class="id" title="var">n'</span>) =&gt; //=; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="definition">expr1</span> ?<span class="id" title="definition">expr0</span> ?<span class="id" title="definition">unitrN1</span> ?<span class="id" title="definition">unitr1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>: <span class="id" title="lemma">GRing.mulf_neq0</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="tactic">exact</span> (<span class="id" title="definition">lreg_neq0</span> (<span class="id" title="definition">lregN</span> (@<span class="id" title="definition">lreg1</span> <span class="id" title="var">_</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">exact</span> (<span class="id" title="var">aou</span> )|   |<span class="id" title="tactic">exact</span> (<span class="id" title="var">aou</span>) ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="definition">oner_neq0</span> <span class="id" title="var">_</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> -[(1<span class="id" title="notation">+</span><span class="id" title="var">n'</span>)%<span class="id" title="var">N</span>]/<span class="id" title="var">n'</span><span class="id" title="notation">.+1</span>  (<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssreflect.html#iffLR"><span class="id" title="lemma">iffLR</span></a> (<span class="id" title="definition">charf0P</span> <span class="id" title="var">_</span>) <span class="id" title="definition">Cchar</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="diag_vec" class="idref" href="#diag_vec"><span class="id" title="definition">diag_vec</span></a> : <span class="id" title="notation">'</span><span class="id" title="notation">rV</span><span class="id" title="notation">[</span><a class="idref" href="Friendship.adj2_matrix.html#R"><span class="id" title="definition">R</span></a><span class="id" title="notation">]</span><span class="id" title="notation">_</span><span class="id" title="notation">(</span>1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)</span><span class="id" title="notation">)</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">row_mx</span> (<span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a><span class="id" title="notation">+</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span><span class="id" title="notation">%:</span><span class="id" title="notation">M</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <span class="id" title="notation">'</span><span class="id" title="notation">rV_1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="definition">const_mx</span> <a class="idref" href="Friendship.adj2_matrix.html#R"><span class="id" title="definition">R</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <span class="id" title="notation">'</span><span class="id" title="notation">rV_</span><span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="adj2_diag" class="idref" href="#adj2_diag"><span class="id" title="definition">adj2_diag</span></a> : <a class="idref" href="Friendship.adj2_matrix.html#matN"><span class="id" title="definition">matN</span></a> := <span class="id" title="definition">diag_mx</span> <a class="idref" href="Friendship.adj2_matrix.html#diag_vec"><span class="id" title="definition">diag_vec</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="adj_diag_block_form" class="idref" href="#adj_diag_block_form"><span class="id" title="lemma">adj_diag_block_form</span></a> : <a class="idref" href="Friendship.adj2_matrix.html#adj2_diag"><span class="id" title="definition">adj2_diag</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> @<span class="id" title="definition">block_mx</span> <span class="id" title="var">_</span> 1 (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1)%<span class="id" title="var">N</span> 1 (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1)%<span class="id" title="var">N</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">const_mx</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a><span class="id" title="notation">+</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span>) 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0            <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span><span class="id" title="notation">%:</span><span class="id" title="notation">M</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="Friendship.adj2_matrix.html#adj2_diag"><span class="id" title="definition">adj2_diag</span></a> /<a class="idref" href="Friendship.adj2_matrix.html#diag_vec"><span class="id" title="definition">diag_vec</span></a> <span class="id" title="lemma">diag_mx_row</span> <span class="id" title="lemma">diag_const_mx</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span> <span class="id" title="var">oeua</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="definition">diag_mx</span> (@<span class="id" title="definition">scalar_mx</span> <span class="id" title="var">_</span> 1 (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a><span class="id" title="notation">+</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1)%<span class="id" title="var">N</span><span class="id" title="notation">%:</span><span class="id" title="notation">R</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a>@<span class="id" title="definition">const_mx</span> <a class="idref" href="Friendship.adj2_matrix.html#R"><span class="id" title="definition">R</span></a> 1 1 (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a><span class="id" title="notation">+</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1)%<span class="id" title="var">N</span><span class="id" title="notation">%:</span><span class="id" title="notation">R</span><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">oeua</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">mx11_scalar</span> (<span class="id" title="definition">const_mx</span> <span class="id" title="var">_</span>)) (<span class="id" title="lemma">mx11_scalar</span> (<span class="id" title="definition">diag_mx</span> <span class="id" title="var">_</span>)) !<span class="id" title="lemma">mxE</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;//=.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="adj2" class="idref" href="#adj2"><span class="id" title="definition">adj2</span></a> : <span class="id" title="notation">'</span><span class="id" title="notation">M</span><span class="id" title="notation">[</span><a class="idref" href="Friendship.adj2_matrix.html#R"><span class="id" title="definition">R</span></a><span class="id" title="notation">]</span><span class="id" title="notation">_</span><span class="id" title="notation">(</span>1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)</span><span class="id" title="notation">)</span>  := <span class="id" title="notation">(</span><span class="id" title="definition">const_mx</span> 1<span class="id" title="notation">)</span> <span class="id" title="notation">+</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span><span class="id" title="notation">%:</span><span class="id" title="notation">M</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="adj2_block_form" class="idref" href="#adj2_block_form"><span class="id" title="lemma">adj2_block_form</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> @<span class="id" title="definition">block_mx</span> <span class="id" title="var">_</span> 1 (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1)%<span class="id" title="var">N</span> 1 (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1)%<span class="id" title="var">N</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">const_mx</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">R</span>)     (<span class="id" title="definition">const_mx</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">const_mx</span> 1)        (<span class="id" title="notation">(</span><span class="id" title="definition">const_mx</span> 1<span class="id" title="notation">)</span> <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span><span class="id" title="notation">%:</span><span class="id" title="notation">M</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(@<span class="id" title="lemma">submxK</span> <a class="idref" href="Friendship.adj2_matrix.html#R"><span class="id" title="definition">R</span></a> 1 (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1)%<span class="id" title="var">N</span> 1 (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1)%<span class="id" title="var">N</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> -&gt; : <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a>@<span class="id" title="definition">ulsubmx</span> <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">const_mx</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">matrixP</span>=&gt; <span class="id" title="var">i</span> <span class="id" title="var">j</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">mxE</span> .<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> {<span class="id" title="var">i</span>} {<span class="id" title="var">j</span>} -&gt; : <span class="id" title="definition">lshift</span> (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1) <span class="id" title="var">i</span> <span class="id" title="notation">==</span> <span class="id" title="definition">lshift</span> (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1) <span class="id" title="var">j</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">ord1</span>; <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">eqP</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -{1}(<span class="id" title="definition">mulr1n</span> 1) -<span class="id" title="definition">mulrnDr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span> -&gt; : (1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)</span>)%<span class="id" title="var">N</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="tactic">by</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>: <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.kge1"><span class="id" title="variable">kge1</span></a>; <span class="id" title="tactic">case</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> =&gt; [|<span class="id" title="var">k'</span> <span class="id" title="var">_</span>] //=; <span class="id" title="var">ssrnat_lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> -&gt; : <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a>@<span class="id" title="definition">ursubmx</span> <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">const_mx</span> 1. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">matrixP</span>=&gt; <span class="id" title="var">i</span> <span class="id" title="var">j</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">mxE</span> !<span class="id" title="lemma">ord1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> -&gt; : <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="definition">lshift</span> (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1) 0 <span class="id" title="notation">==</span> <span class="id" title="definition">rshift</span> 1 <span class="id" title="var">j</span><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">eq_lrshift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">mulr0n</span> <span class="id" title="definition">addr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> -&gt; : <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a>@<span class="id" title="definition">dlsubmx</span> <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">const_mx</span> 1. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">matrixP</span>=&gt; <span class="id" title="var">i</span> <span class="id" title="var">j</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">mxE</span> !<span class="id" title="lemma">ord1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> -&gt; : <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="definition">rshift</span> 1 <span class="id" title="var">i</span> <span class="id" title="notation">==</span> <span class="id" title="definition">lshift</span> (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1) 0<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">eq_rlshift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">mulr0n</span> <span class="id" title="definition">addr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span> -&gt; : <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a>@<span class="id" title="definition">drsubmx</span> <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">const_mx</span> 1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span><span class="id" title="notation">%:</span><span class="id" title="notation">M</span> <span class="id" title="tactic">by</span> []. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">matrixP</span>=&gt; <span class="id" title="var">i</span> <span class="id" title="var">j</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">mxE</span> <span class="id" title="lemma">eq_rshift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="D_m_P_eq" class="idref" href="#D_m_P_eq"><span class="id" title="lemma">D_m_P_eq</span></a> : <a class="idref" href="Friendship.adj2_matrix.html#P"><span class="id" title="definition">P</span></a> <span class="id" title="notation">*</span><span class="id" title="notation">m</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Friendship.adj2_matrix.html#adj2_diag"><span class="id" title="definition">adj2_diag</span></a> <span class="id" title="notation">*</span><span class="id" title="notation">m</span> <a class="idref" href="Friendship.adj2_matrix.html#P"><span class="id" title="definition">P</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="Friendship.adj2_matrix.html#P"><span class="id" title="definition">P</span></a> <a class="idref" href="Friendship.adj2_matrix.html#adj2_block_form"><span class="id" title="lemma">adj2_block_form</span></a> <a class="idref" href="Friendship.adj2_matrix.html#adj_diag_block_form"><span class="id" title="lemma">adj_diag_block_form</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!<span class="id" title="lemma">mulmx_block</span> !<span class="id" title="lemma">mul0mx</span> !<span class="id" title="definition">addr0</span> !<span class="id" title="definition">add0r</span> !<span class="id" title="lemma">mul_scalar_mx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="lemma">mx11_scalar</span> (<span class="id" title="definition">const_mx</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">+</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span>)) (<span class="id" title="lemma">mx11_scalar</span> (<span class="id" title="definition">const_mx</span> 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS"><span class="id" title="abbreviation">RHS</span></a>](<span class="id" title="lemma">mx11_scalar</span> (<span class="id" title="definition">const_mx</span> 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!<span class="id" title="lemma">mxE</span> -<span class="id" title="lemma">scalar_mxM</span> //= !<span class="id" title="lemma">mul_scalar_mx</span> !<span class="id" title="lemma">scalemx_const</span> !<span class="id" title="definition">mulr1</span>  <span class="id" title="lemma">scale_scalar_mx</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Top&nbsp;left&nbsp;block&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="definition">mul1r</span> <a class="idref" href="Friendship.matrix_lemmas.html#dotmul"><span class="id" title="lemma">dotmul</span></a>  (<span class="id" title="lemma">mx11_scalar</span> (<span class="id" title="definition">const_mx</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="lemma">mx11_scalar</span> (<span class="id" title="definition">const_mx</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!<span class="id" title="lemma">mxE</span> (<span class="id" title="lemma">mx11_scalar</span> (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">R</span><span class="id" title="notation">%:</span><span class="id" title="notation">M</span> <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span><span class="id" title="notation">%:</span><span class="id" title="notation">M</span>)) <span class="id" title="lemma">mxE</span>  !(<span class="id" title="lemma">mxE</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0 0) //=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!<span class="id" title="definition">mulr1n</span> -<span class="id" title="definition">natrD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> -&gt; : (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)</span>)%<span class="id" title="var">N</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">+</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span>1)%<span class="id" title="var">N</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>:  <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.nge1"><span class="id" title="variable">nge1</span></a> =&gt; /<span class="id" title="lemma">ltP</span>; <span class="id" title="var">ssrnat_lia</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Bot&nbsp;left&nbsp;block:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">scalar_mxC</span> <span class="id" title="lemma">mul_scalar_mx</span> <span class="id" title="lemma">scalemx_const</span> <span class="id" title="definition">mulr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> -&gt;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a>@<span class="id" title="definition">const_mx</span> <a class="idref" href="Friendship.adj2_matrix.html#R"><span class="id" title="definition">R</span></a> (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1) 1 <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">R</span> <span class="id" title="notation">+</span> <span class="id" title="definition">const_mx</span> (-1)<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">const_mx</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span> .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">matrixP</span> =&gt; <span class="id" title="var">i</span> <span class="id" title="var">j</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">mxE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.kge1"><span class="id" title="variable">kge1</span></a>; <span class="id" title="tactic">case</span>: <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> =&gt; [//| <span class="id" title="var">k'</span> <span class="id" title="var">_</span>].<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<span class="id" title="definition">subn</span> /<span class="id" title="definition">subn_rec</span> //= <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_0_r"><span class="id" title="lemma">PeanoNat.Nat.sub_0_r</span></a>  [<span class="id" title="var">_</span><span class="id" title="notation">.+1</span>]/((1<span class="id" title="notation">+</span><span class="id" title="var">k'</span>)%<span class="id" title="var">N</span>) -/<span class="id" title="definition">addn</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">natrD</span> <span class="id" title="definition">addrC</span> <span class="id" title="definition">addrA</span> (<span class="id" title="definition">addNr</span> 1) <span class="id" title="definition">add0r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;bot&nbsp;left&nbsp;block&nbsp;done&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;1Ã1^T&nbsp;=&nbsp;ones;&nbsp;used&nbsp;in&nbsp;2&nbsp;places.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> -&gt; : <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a>@<span class="id" title="definition">const_mx</span> <a class="idref" href="Friendship.adj2_matrix.html#R"><span class="id" title="definition">R</span></a> (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1) (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1) 1<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="definition">const_mx</span> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <span class="id" title="notation">'</span><span class="id" title="notation">cV__</span><span class="id" title="notation">)</span> <span class="id" title="notation">*</span><span class="id" title="notation">m</span> <span class="id" title="notation">(</span><span class="id" title="definition">const_mx</span> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <span class="id" title="notation">'</span><span class="id" title="notation">rV__</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">matrixP</span> =&gt; <span class="id" title="var">i</span> <span class="id" title="var">j</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">mxE</span>  (<span class="id" title="lemma">eq_bigr</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#94502d422d70bbaf4f390946d9885b7c"><span class="id" title="notation">fun</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#94502d422d70bbaf4f390946d9885b7c"><span class="id" title="notation">=&gt;</span></a>1))  ?<span class="id" title="lemma">big_const_ord</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="definition">iter_addr</span> ?<span class="id" title="definition">addr0</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">i'</span> <span class="id" title="var">_</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">mxE</span> <span class="id" title="definition">mulr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;end&nbsp;proof&nbsp;&nbsp;of&nbsp;1Ã1&nbsp;=&nbsp;ones*)</span><br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Top&nbsp;right&nbsp;piece&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mulmxDr</span>  [<span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS"><span class="id" title="abbreviation">LHS</span></a>]<span class="id" title="lemma">mulmxA</span> <a class="idref" href="Friendship.matrix_lemmas.html#dotmul"><span class="id" title="lemma">dotmul</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="lemma">mx11_scalar</span> (<span class="id" title="definition">const_mx</span> <span class="id" title="var">_</span>)) (<span class="id" title="lemma">mxE</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="lemma">mul_scalar_mx</span>  <span class="id" title="lemma">mul_mx_scalar</span> !<span class="id" title="lemma">scalemx_const</span> -!<span class="id" title="definition">raddfD</span> //=.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> -&gt; : 1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span> <span class="id" title="notation">*</span> 1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span> <span class="id" title="notation">*</span> 1<span class="id" title="notation">)</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">+</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a><a class="idref" href="Friendship.adj2_matrix.html#R"><span class="id" title="definition">R</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">mulr1</span>  -{1}[<span class="id" title="tactic">in</span> 1](<span class="id" title="definition">mulr1n</span> 1) -!<span class="id" title="definition">natrD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span> -&gt; : (1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">))</span>)%<span class="id" title="var">N</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">+</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1)%<span class="id" title="var">N</span> <span class="id" title="tactic">by</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>: <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.nge1"><span class="id" title="variable">nge1</span></a> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.kge1"><span class="id" title="variable">kge1</span></a> =&gt; /<span class="id" title="lemma">ltP</span> <span class="id" title="var">nge1'</span> /<span class="id" title="lemma">ltP</span> <span class="id" title="var">kge1'</span>; <span class="id" title="var">ssrnat_lia</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Top&nbsp;right&nbsp;piece&nbsp;done&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Bot&nbsp;right&nbsp;piece&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">scaleN1r</span> [<span class="id" title="tactic">in</span> <span class="id" title="notation">-(</span><span class="id" title="var">_</span> <span class="id" title="notation">+</span> <span class="id" title="var">_</span><span class="id" title="notation">)</span>] <span class="id" title="definition">raddfD</span> //=  <span class="id" title="definition">addrA</span> <span class="id" title="definition">addrN</span> <span class="id" title="definition">add0r</span> <span class="id" title="definition">mulrN1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-<span class="id" title="definition">mulNrn</span> -<span class="id" title="definition">raddfN</span> //= <span class="id" title="definition">mulNrn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="diagonalizable_m" class="idref" href="#diagonalizable_m"><span class="id" title="lemma">diagonalizable_m</span></a> : <a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a> <span class="id" title="notation">~</span><span class="id" title="notation">_P</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_diag"><span class="id" title="definition">adj2_diag</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">simmxW</span>; [ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">row_free_unit</span>; <span class="id" title="tactic">exact</span> <a class="idref" href="Friendship.adj2_matrix.html#P_unit"><span class="id" title="lemma">P_unit</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  <span class="id" title="tactic">exact</span> <a class="idref" href="Friendship.adj2_matrix.html#D_m_P_eq"><span class="id" title="lemma">D_m_P_eq</span></a>].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="char_poly_adj2" class="idref" href="#char_poly_adj2"><span class="id" title="lemma">char_poly_adj2</span></a>: <span class="id" title="definition">char_poly</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span> <span class="id" title="notation">-</span> <span class="id" title="notation">(</span><span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">+</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span><span class="id" title="notation">)%:</span><span class="id" title="notation">P</span><span class="id" title="notation">)</span> <span class="id" title="notation">*</span> <span class="id" title="notation">(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span> <span class="id" title="notation">-</span> <span class="id" title="notation">(</span><span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span><span class="id" title="notation">)%:</span><span class="id" title="notation">P</span><span class="id" title="notation">)</span> <span class="id" title="notation">^+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="Friendship.matrix_lemmas.html#simmx_charpoly"><span class="id" title="lemma">simmx_charpoly</span></a> <a class="idref" href="Friendship.adj2_matrix.html#P_unit"><span class="id" title="lemma">P_unit</span></a> <a class="idref" href="Friendship.adj2_matrix.html#diagonalizable_m"><span class="id" title="lemma">diagonalizable_m</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">adj2_trig</span> : <span class="id" title="definition">is_trig_mx</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_diag"><span class="id" title="definition">adj2_diag</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: (<span class="id" title="lemma">is_diag_mx_is_trig</span> (<span class="id" title="lemma">diag_mx_is_diag</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">char_poly_trig</span> <span class="id" title="var">adj2_trig</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (@<span class="id" title="lemma">big_split_ord</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 1%<span class="id" title="var">N</span> (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1) <span class="id" title="var">_</span> <span class="id" title="var">_</span>) //= <a class="idref" href="Friendship.adj2_matrix.html#adj_diag_block_form"><span class="id" title="lemma">adj_diag_block_form</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="lemma">eq_bigr</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#94502d422d70bbaf4f390946d9885b7c"><span class="id" title="notation">fun</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#94502d422d70bbaf4f390946d9885b7c"><span class="id" title="notation">=&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#94502d422d70bbaf4f390946d9885b7c"><span class="id" title="notation">(</span></a><span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">-</span><span class="id" title="notation">(</span><span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">+</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a><a class="idref" href="Friendship.adj2_matrix.html#R"><span class="id" title="definition">R</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">%:</span><span class="id" title="notation">P</span><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#94502d422d70bbaf4f390946d9885b7c"><span class="id" title="notation">)</span></a>)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt;<span class="id" title="var">i</span> <span class="id" title="var">_</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">block_mxEul</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span> -&gt; : <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a>@<span class="id" title="definition">const_mx</span> <a class="idref" href="Friendship.adj2_matrix.html#R"><span class="id" title="definition">R</span></a> 1 1 <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">+</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span> <span class="id" title="var">i</span> <span class="id" title="var">i</span><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">+</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span> <span class="id" title="tactic">by</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mxE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> [<span class="id" title="tactic">in</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">_</span><span class="id" title="notation">*</span><a class="idref" href="Friendship.adj2_matrix.html#X:7"><span class="id" title="variable">X</span></a>](<span class="id" title="lemma">eq_bigr</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#94502d422d70bbaf4f390946d9885b7c"><span class="id" title="notation">fun</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#94502d422d70bbaf4f390946d9885b7c"><span class="id" title="notation">=&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#94502d422d70bbaf4f390946d9885b7c"><span class="id" title="notation">(</span></a><span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">-</span><span class="id" title="notation">(</span><span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span><span class="id" title="notation">)</span> <span class="id" title="notation">%:</span><span class="id" title="notation">P</span><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#94502d422d70bbaf4f390946d9885b7c"><span class="id" title="notation">)</span></a>)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt;<span class="id" title="var">i</span> <span class="id" title="var">_</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">block_mxEdr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span> -&gt; : <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span><span class="id" title="notation">%:</span><span class="id" title="notation">M</span> <span class="id" title="notation">i</span> <span class="id" title="notation">i</span><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a><a class="idref" href="Friendship.adj2_matrix.html#R"><span class="id" title="definition">R</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">by</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mxE</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> -&gt; : (<span class="id" title="var">i</span><span class="id" title="notation">==</span><span class="id" title="var">i</span>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">eqP</span> .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">mulr1n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_const_ord</span> !<span class="id" title="definition">iter_mulr</span> !<span class="id" title="definition">mulr1</span> <span class="id" title="definition">expr1</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="lams" class="idref" href="#lams"><span class="id" title="definition">lams</span></a> : <span class="id" title="notation">(</span>1<span class="id" title="notation">+(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)</span><span class="id" title="notation">).-</span><span class="id" title="notation">tuple</span> <span class="id" title="notation">algC</span> := <span class="id" title="definition">cons_tuple</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">+</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">nseq_tuple</span> (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1) <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lams_prod" class="idref" href="#lams_prod"><span class="id" title="lemma">lams_prod</span></a>: <span class="id" title="definition">char_poly</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">prod_</span><span class="id" title="notation">(</span><a id="l:10" class="idref" href="#l:10"><span class="id" title="binder">l</span></a> <span class="id" title="notation">&lt;-</span> <a class="idref" href="Friendship.adj2_matrix.html#lams"><span class="id" title="definition">lams</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span> <span class="id" title="notation">-</span> <a class="idref" href="Friendship.adj2_matrix.html#l:8"><span class="id" title="variable">l</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">P</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Friendship.adj2_matrix.html#char_poly_adj2"><span class="id" title="lemma">char_poly_adj2</span></a>  /<a class="idref" href="Friendship.adj2_matrix.html#lams"><span class="id" title="definition">lams</span></a> <span class="id" title="lemma">big_cons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#f_equal"><span class="id" title="lemma">f_equal</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_tnth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">eq_bigr</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#94502d422d70bbaf4f390946d9885b7c"><span class="id" title="notation">fun</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#94502d422d70bbaf4f390946d9885b7c"><span class="id" title="notation">=&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#94502d422d70bbaf4f390946d9885b7c"><span class="id" title="notation">(</span></a><span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">-</span><span class="id" title="notation">(</span><span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span><span class="id" title="notation">)</span> <span class="id" title="notation">%:</span><span class="id" title="notation">P</span><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#94502d422d70bbaf4f390946d9885b7c"><span class="id" title="notation">)</span></a>)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">i</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">tvalK</span>  <span class="id" title="lemma">tcastE</span> <span class="id" title="lemma">tnth_nseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_const_ord</span> <span class="id" title="definition">iter_mulr</span> <span class="id" title="definition">mulr1</span>  <span class="id" title="lemma">size_tuple</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="is_square_root" class="idref" href="#is_square_root"><span class="id" title="definition">is_square_root</span></a> <a id="A:11" class="idref" href="#A:11"><span class="id" title="binder">A</span></a> := <a class="idref" href="Friendship.adj2_matrix.html#A:11"><span class="id" title="variable">A</span></a> <span class="id" title="notation">*</span><span class="id" title="notation">m</span> <a class="idref" href="Friendship.adj2_matrix.html#A:11"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a>.<br/>
&nbsp;&nbsp;<span class="comment">(*From&nbsp;mathcomp&nbsp;Require&nbsp;Import&nbsp;seq.*)</span><br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="adj_mtx_char_poly" class="idref" href="#adj_mtx_char_poly"><span class="id" title="lemma">adj_mtx_char_poly</span></a> <a id="adj:12" class="idref" href="#adj:12"><span class="id" title="binder">adj</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Friendship.adj2_matrix.html#is_square_root"><span class="id" title="definition">is_square_root</span></a> <a class="idref" href="Friendship.adj2_matrix.html#adj:12"><span class="id" title="variable">adj</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*char_poly&nbsp;mtx&nbsp;=&nbsp;\prod_(Î¼&nbsp;&lt;-&nbsp;Î¼s)&nbsp;('X&nbsp;-&nbsp;Î¼&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Specif.html#f92718946b2f68c8f7100be4d6b45f82"><span class="id" title="notation">{</span></a> <a id="2107bdf935878d2b7476b622b20a628d" class="idref" href="#2107bdf935878d2b7476b622b20a628d"><span class="id" title="binder">Î¼s'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Specif.html#f92718946b2f68c8f7100be4d6b45f82"><span class="id" title="notation">:</span></a> <span class="id" title="notation">(</span>1<span class="id" title="notation">+(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)</span><span class="id" title="notation">).-</span><span class="id" title="notation">tuple</span> <span class="id" title="notation">R</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Specif.html#f92718946b2f68c8f7100be4d6b45f82"><span class="id" title="notation">|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">char_poly</span> <a class="idref" href="Friendship.adj2_matrix.html#adj:12"><span class="id" title="variable">adj</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">prod_</span><span class="id" title="notation">(</span><a id="92bb74d3932762c48d4871fada859cc7" class="idref" href="#92bb74d3932762c48d4871fada859cc7"><span class="id" title="binder">Î¼</span></a> <span class="id" title="notation">&lt;-</span> <a class="idref" href="Friendship.adj2_matrix.html#187ed7096d3e518d24e3094b695ad913"><span class="id" title="variable">Î¼s'</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span> <span class="id" title="notation">-</span> <a class="idref" href="Friendship.adj2_matrix.html#7c8b1c219bc88250c0d512ae99f99ad0"><span class="id" title="variable">Î¼</span></a> <span class="id" title="notation">%:</span><span class="id" title="notation">P</span><span class="id" title="notation">)</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Specif.html#f92718946b2f68c8f7100be4d6b45f82"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">all2</span> (<span class="id" title="keyword">fun</span> <a id="b6f90fec3ae68984b746c42c6f79f357" class="idref" href="#b6f90fec3ae68984b746c42c6f79f357"><span class="id" title="binder">Î¼</span></a> <a id="b3afb023e75de2fd84a107de678c41e7" class="idref" href="#b3afb023e75de2fd84a107de678c41e7"><span class="id" title="binder">Î»</span></a> =&gt; <a class="idref" href="Friendship.adj2_matrix.html#b6f90fec3ae68984b746c42c6f79f357"><span class="id" title="variable">Î¼</span></a><span class="id" title="notation">^</span>2 <span class="id" title="notation">==</span> <a class="idref" href="Friendship.adj2_matrix.html#b3afb023e75de2fd84a107de678c41e7"><span class="id" title="variable">Î»</span></a>) <a class="idref" href="Friendship.adj2_matrix.html#2107bdf935878d2b7476b622b20a628d"><span class="id" title="variable">Î¼s'</span></a> (<span class="id" title="definition">cons_tuple</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">+</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">nseq_tuple</span> (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1) <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)%:</span><span class="id" title="notation">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Specif.html#f92718946b2f68c8f7100be4d6b45f82"><span class="id" title="notation">}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">adj2_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> <span class="id" title="var">p</span> := <span class="id" title="definition">char_poly</span> <span class="id" title="var">adj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">Î¼s'</span> <span class="id" title="var">prop</span>] := <span class="id" title="lemma">closed_field_poly_normal</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">monicP</span> (<span class="id" title="lemma">char_poly_monic</span> <span class="id" title="var">adj</span>)) <span class="id" title="definition">scale1r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">deg_p</span> := <span class="id" title="lemma">size_char_poly</span> <span class="id" title="var">adj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">size_Î¼s'</span> : <span class="id" title="notation">(</span><span class="id" title="definition">seq.size</span> <span class="id" title="var">Î¼s'</span><span class="id" title="notation">)</span> <span class="id" title="notation">==</span> (1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)</span>)%<span class="id" title="var">N</span> <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">prop</span> <span class="id" title="lemma">size_prod_XsubC</span>  <span class="id" title="tactic">in</span> <span class="id" title="var">deg_p</span>; <span class="id" title="tactic">apply</span> /<span class="id" title="lemma">eqP</span>; <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">deg_p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> <span class="id" title="var">tÎ¼s'</span> := (@<span class="id" title="constructor">Tuple</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Î¼s'</span> <span class="id" title="var">size_Î¼s'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">tp</span> : <span class="id" title="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">prod_</span><span class="id" title="notation">(</span><a id="z:22" class="idref" href="#z:22"><span class="id" title="binder">z</span></a> <span class="id" title="notation">&lt;-</span> <span class="id" title="var">tÎ¼s'</span><span class="id" title="notation">)</span> <span class="id" title="notation">(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span> <span class="id" title="notation">-</span> <a class="idref" href="Friendship.adj2_matrix.html#z:20"><span class="id" title="variable">z</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">P</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">prop</span>; <span class="id" title="tactic">apply</span>: <span class="id" title="lemma">eq_bigr</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">p_X2</span> : <span class="id" title="var">p</span> <span class="id" title="notation">\</span><span class="id" title="notation">Po</span> <span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">^</span>2 <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">prod_</span><span class="id" title="notation">(</span><a id="ce7da57afc20d49ed44f869660ed0d3a" class="idref" href="#ce7da57afc20d49ed44f869660ed0d3a"><span class="id" title="binder">Î¼</span></a> <span class="id" title="notation">&lt;-</span> <span class="id" title="var">tÎ¼s'</span><span class="id" title="notation">)</span> <span class="id" title="notation">(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">^</span>2 <span class="id" title="notation">-</span> <a class="idref" href="Friendship.adj2_matrix.html#a2a522a6e574dd733151ef85e564dfec"><span class="id" title="variable">Î¼</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">P</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">tp</span> (<span class="id" title="lemma">big_endo</span> (<span class="id" title="keyword">fun</span> <a id="q:28" class="idref" href="#q:28"><span class="id" title="binder">q</span></a>=&gt; <a class="idref" href="Friendship.adj2_matrix.html#q:23"><span class="id" title="variable">q</span></a><span class="id" title="notation">\</span><span class="id" title="notation">Po</span> <span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">^</span>2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<span class="id" title="lemma">comp_poly_multiplicative</span> <span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">^</span>2) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> (<span class="id" title="lemma">comp_poly_multiplicative</span> <span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">^</span>2) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">eq_bigr</span> =&gt; <span class="id" title="var">Î¼</span> <span class="id" title="var">_</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">comp_polyD</span> <span class="id" title="lemma">comp_polyX</span> -<span class="id" title="lemma">polyCN</span> <span class="id" title="lemma">comp_polyC</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> <span class="id" title="var">p_Î¼2</span> := (<span class="id" title="notation">\</span><span class="id" title="notation">prod_</span><span class="id" title="notation">(</span><a id="174ba38dc35a862829088bd22b581a95" class="idref" href="#174ba38dc35a862829088bd22b581a95"><span class="id" title="binder">Î¼</span></a> <span class="id" title="notation">&lt;-</span> <span class="id" title="var">tÎ¼s'</span><span class="id" title="notation">)</span> <span class="id" title="notation">(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">^</span>2 <span class="id" title="notation">-</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#87d3e26eea7759d409fce55979467649"><span class="id" title="variable">Î¼</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">P</span><span class="id" title="notation">)^</span>2<span class="id" title="notation">)</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <span class="id" title="notation">{</span><span class="id" title="notation">poly</span> <span class="id" title="abbreviation">algC</span><span class="id" title="notation">}</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">p_Î¼2_eq</span> : <span class="id" title="var">p_Î¼2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">(</span><span class="id" title="notation">\</span><span class="id" title="notation">prod_</span><span class="id" title="notation">(</span><a id="c8293e3a578dd7fbb92a8e5adbfefdca" class="idref" href="#c8293e3a578dd7fbb92a8e5adbfefdca"><span class="id" title="binder">Î¼</span></a> <span class="id" title="notation">&lt;-</span> <span class="id" title="var">tÎ¼s'</span><span class="id" title="notation">)</span> <span class="id" title="notation">(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span> <span class="id" title="notation">-</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#857527bcfb5911404b587ad2f1e079e7"><span class="id" title="variable">Î¼</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">P</span><span class="id" title="notation">)</span><span class="id" title="notation">)</span><span class="id" title="notation">)</span> <span class="id" title="notation">*</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">\</span><span class="id" title="notation">prod_</span><span class="id" title="notation">(</span><a id="ebf1a7b201551060fd61a221a8956d35" class="idref" href="#ebf1a7b201551060fd61a221a8956d35"><span class="id" title="binder">Î¼</span></a> <span class="id" title="notation">&lt;-</span> <span class="id" title="var">tÎ¼s'</span><span class="id" title="notation">)</span> <span class="id" title="notation">(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span> <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#097b8060c48d1509e2273bce6bb2e7d6"><span class="id" title="variable">Î¼</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">P</span><span class="id" title="notation">)</span><span class="id" title="notation">)</span><span class="id" title="notation">)</span> . {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">p_Î¼2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">eq_bigr</span> (<span class="id" title="keyword">fun</span> <a id="5c3f08c3fdc3fb4ff0c4b4e0fc2dcd98" class="idref" href="#5c3f08c3fdc3fb4ff0c4b4e0fc2dcd98"><span class="id" title="binder">Î¼</span></a> =&gt; <span class="id" title="notation">(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span> <span class="id" title="notation">-</span> <a class="idref" href="Friendship.adj2_matrix.html#28bbe7f0fe191f2ee9275176f6a18d69"><span class="id" title="variable">Î¼</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">P</span><span class="id" title="notation">)</span> <span class="id" title="notation">*</span> <span class="id" title="notation">(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span> <span class="id" title="notation">+</span> <a class="idref" href="Friendship.adj2_matrix.html#28bbe7f0fe191f2ee9275176f6a18d69"><span class="id" title="variable">Î¼</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">P</span><span class="id" title="notation">)</span>)) //=. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_split</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">Î¼</span> <span class="id" title="var">_</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">subr_sqr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">tp</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p_Î¼2_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">Î¼s_subst</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">\</span><span class="id" title="notation">prod_</span><span class="id" title="notation">(</span><a id="b6654d0c1bd9ffdd8b574f57429b81b9" class="idref" href="#b6654d0c1bd9ffdd8b574f57429b81b9"><span class="id" title="binder">Î¼</span></a> <span class="id" title="notation">&lt;-</span> <span class="id" title="var">tÎ¼s'</span><span class="id" title="notation">)</span> <span class="id" title="notation">(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span> <span class="id" title="notation">+</span> <a class="idref" href="Friendship.adj2_matrix.html#92d0df58ae5464f192d93fa721cfc384"><span class="id" title="variable">Î¼</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">P</span><span class="id" title="notation">)</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">(</span><span class="id" title="notation">(</span>-1<span class="id" title="notation">)^+(</span>1<span class="id" title="notation">+(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)</span><span class="id" title="notation">)</span><span class="id" title="notation">)%:</span><span class="id" title="notation">P</span> <span class="id" title="notation">*</span> <span class="id" title="notation">(</span><span class="id" title="var">p</span> <span class="id" title="notation">\</span><span class="id" title="notation">Po</span> <span class="id" title="notation">(</span><span class="id" title="notation">-</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">)</span><span class="id" title="notation">)</span>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span>  <span class="id" title="var">p_X2</span> <span class="id" title="var">p_Î¼2</span> <span class="id" title="var">p_Î¼2_eq</span> <span class="id" title="var">adj2_eq</span>  <span class="id" title="var">k</span> <span class="id" title="var">kge1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">eq_bigr</span> (<span class="id" title="keyword">fun</span> <a id="a2ad755c5c2fe238ce5dfafab7942f14" class="idref" href="#a2ad755c5c2fe238ce5dfafab7942f14"><span class="id" title="binder">Î¼</span></a> =&gt; <span class="id" title="notation">(</span>-1<span class="id" title="notation">)*(</span><span class="id" title="notation">-</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span> <span class="id" title="notation">-</span> <a class="idref" href="Friendship.adj2_matrix.html#44b6fa76b3a0e5387699e400acfc76fa"><span class="id" title="variable">Î¼</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">P</span><span class="id" title="notation">)</span>)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt;  <span class="id" title="var">Î¼</span> <span class="id" title="var">_</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">mulrDr</span> !<span class="id" title="definition">mulN1r</span> !<span class="id" title="definition">opprK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_split</span> //=.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span>  -&gt; : <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">\</span><span class="id" title="notation">prod_</span><span class="id" title="notation">(</span><a id="i:55" class="idref" href="#i:55"><span class="id" title="binder">i</span></a> <span class="id" title="notation">&lt;-</span> <span class="id" title="var">Î¼s'</span><span class="id" title="notation">)</span> -1<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">(</span>-1<span class="id" title="notation">)^+(</span>1<span class="id" title="notation">+(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a><span class="id" title="notation">-</span>1<span class="id" title="notation">)</span><span class="id" title="notation">)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">RR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">prop</span> <span class="id" title="var">tÎ¼s'</span> <span class="id" title="var">tp</span> <span class="id" title="var">p</span>  <span class="id" title="var">adj</span> .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> &lt;- : <span class="id" title="definition">seq.size</span> <span class="id" title="var">Î¼s'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> (1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)</span>)%<span class="id" title="var">N</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <span class="id" title="lemma">eqP</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">size_Î¼s'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">size_Î¼s'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">elim</span>: <span class="id" title="var">Î¼s'</span> =&gt; [|<span class="id" title="var">Î¼s''</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> -<span class="id" title="definition">signr_odd</span>  <span class="id" title="definition">expr0</span> <span class="id" title="lemma">big_nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">l</span> <span class="id" title="var">indL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_cons</span> <span class="id" title="var">indL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="definition">exprS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span> -&gt; : <span class="id" title="notation">(</span><span class="id" title="definition">seq.size</span> <span class="id" title="var">l</span><span class="id" title="notation">).+1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">seq.size</span> (<span class="id" title="var">Î¼s''</span> <span class="id" title="notation">::</span> <span class="id" title="var">l</span>) <span class="id" title="tactic">by</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> -&gt; : <span class="id" title="notation">(</span>-1<span class="id" title="notation">)</span> <span class="id" title="notation">^+</span> <span class="id" title="notation">(</span>1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)</span><span class="id" title="notation">)</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">(</span><span class="id" title="notation">(</span>-1<span class="id" title="notation">)</span> <span class="id" title="notation">^+</span> <span class="id" title="notation">(</span>1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)</span><span class="id" title="notation">)</span><span class="id" title="notation">)%:</span><span class="id" title="notation">P</span>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">prop</span> <span class="id" title="var">tÎ¼s'</span> <span class="id" title="var">tp</span>  <span class="id" title="var">p</span> <span class="id" title="var">adj</span> .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">RR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> ((1 <span class="id" title="notation">+</span> (<a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1)%<span class="id" title="var">N</span>)%<span class="id" title="var">N</span>) =&gt; <span class="id" title="var">nn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="definition">signr_odd</span> -[<span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS"><span class="id" title="abbreviation">RHS</span></a>]<span class="id" title="definition">signr_odd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: (<span class="id" title="definition">odd</span> <span class="id" title="var">nn</span>) =&gt; //=; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="definition">expr0</span> ?<span class="id" title="definition">expr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">rmorphN1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_endo</span> (<span class="id" title="keyword">fun</span> <a id="q:58" class="idref" href="#q:58"><span class="id" title="binder">q</span></a>=&gt; <a class="idref" href="Friendship.adj2_matrix.html#q:56"><span class="id" title="variable">q</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">Po</span> <span class="id" title="notation">(</span><span class="id" title="notation">-</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<span class="id" title="lemma">comp_poly_multiplicative</span> (<span class="id" title="notation">-</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span>) ))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> (<span class="id" title="lemma">comp_poly_multiplicative</span> (<span class="id" title="notation">-</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span>) ))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> [<span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS"><span class="id" title="abbreviation">RHS</span></a>](<span class="id" title="lemma">eq_bigr</span> (<span class="id" title="keyword">fun</span> <a id="93bb95223b52667c169786215e3d683d" class="idref" href="#93bb95223b52667c169786215e3d683d"><span class="id" title="binder">Î¼</span></a> =&gt; <span class="id" title="notation">-</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span> <span class="id" title="notation">-</span> <a class="idref" href="Friendship.adj2_matrix.html#17b6cf113b055022013d309017681458"><span class="id" title="variable">Î¼</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">P</span>)) //=; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span> =&gt; <span class="id" title="var">Î¼</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">comp_polyB</span> <span class="id" title="lemma">comp_polyX</span> <span class="id" title="lemma">comp_polyC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {}<span class="id" title="var">Î¼s_subst</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p_Î¼2_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">pNx_det</span> : <span class="id" title="var">p</span> <span class="id" title="notation">\</span><span class="id" title="notation">Po</span> <span class="id" title="notation">-</span> <span class="id" title="notation">'</span><span class="id" title="notation">X</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">det</span> <span class="id" title="notation">(</span> <span class="id" title="notation">-(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">%:</span><span class="id" title="notation">M</span><span class="id" title="notation">)</span> <span class="id" title="notation">-</span> <span class="id" title="definition">map_mx</span> <span class="id" title="definition">polyC</span> <span class="id" title="var">adj</span> <span class="id" title="notation">)</span>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">k</span> <span class="id" title="var">kge1</span> <span class="id" title="var">nge1</span> <span class="id" title="var">adj2_eq</span> <span class="id" title="var">Î¼s'</span> <span class="id" title="var">prop</span> <span class="id" title="var">size_Î¼s'</span> <span class="id" title="var">tÎ¼s'</span> <span class="id" title="var">tp</span> <span class="id" title="var">p_X2</span> <span class="id" title="var">p_Î¼2</span> <span class="id" title="var">p_Î¼2_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<span class="id" title="var">p</span> /<span class="id" title="definition">char_poly</span> /<span class="id" title="definition">char_poly_mx</span> -<span class="id" title="lemma">det_map_mx</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span> -&gt; : <span class="id" title="definition">map_mx</span> (<span class="id" title="definition">comp_poly</span> (<span class="id" title="notation">-</span> <span class="id" title="notation">'</span><span class="id" title="notation">X</span>)) (<span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">%:</span><span class="id" title="notation">M</span> <span class="id" title="notation">-</span> <span class="id" title="definition">map_mx</span> <span class="id" title="definition">polyC</span> <span class="id" title="var">adj</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-</span> <span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">%:</span><span class="id" title="notation">M</span> <span class="id" title="notation">-</span> <span class="id" title="definition">map_mx</span> <span class="id" title="definition">polyC</span> <span class="id" title="var">adj</span> <span class="id" title="tactic">by</span> []. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_mxD</span> //= <span class="id" title="lemma">map_scalar_mx</span>  //= <span class="id" title="lemma">comp_polyX</span> <span class="id" title="definition">rmorphN</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span> -&gt; : <span class="id" title="definition">map_mx</span> (<span class="id" title="definition">comp_poly</span> (<span class="id" title="notation">-</span> <span class="id" title="notation">'</span><span class="id" title="notation">X</span>)) (<span class="id" title="notation">-</span> <span class="id" title="definition">map_mx</span> <span class="id" title="definition">polyC</span> <span class="id" title="var">adj</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">-</span> <span class="id" title="definition">map_mx</span> <span class="id" title="definition">polyC</span> <span class="id" title="var">adj</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> []. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="definition">rmorphN</span> //=  -<span class="id" title="lemma">map_mx_comp</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span> -&gt; : <span class="id" title="definition">map_mx</span> (<span class="id" title="definition">comp_poly</span> (<span class="id" title="notation">-</span> <span class="id" title="notation">'</span><span class="id" title="notation">X</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e"><span class="id" title="notation">o</span></a> <span class="id" title="definition">polyC</span>) <span class="id" title="var">adj</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">map_mx</span> <span class="id" title="definition">polyC</span> <span class="id" title="var">adj</span> <span class="id" title="tactic">by</span> []. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span> : <span class="id" title="definition">comp_poly</span> (<span class="id" title="notation">-</span> <span class="id" title="notation">'</span><span class="id" title="notation">X</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e"><span class="id" title="notation">o</span></a> <span class="id" title="definition">polyC</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssrfun.html#876aa133fb3472bffd492f74ff496035"><span class="id" title="notation">=1</span></a> <span class="id" title="definition">polyC</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">comp_comp</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">matrixP</span> =&gt; <span class="id" title="var">i</span> <span class="id" title="var">j</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">mxE</span> (<span class="id" title="var">comp_comp</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">R</span> {<span class="id" title="var">p</span> <span class="id" title="var">adj</span> } <span class="id" title="var">c</span> //=;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">comp_polyC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {}<span class="id" title="var">pNx_det</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p_Î¼2_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">p_Î¼2_det</span> : <span class="id" title="var">p_Î¼2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">det</span> <span class="id" title="notation">(</span><span class="id" title="notation">(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">^</span>2<span class="id" title="notation">)%:</span><span class="id" title="notation">M</span>  <span class="id" title="notation">-</span> <span class="id" title="definition">map_mx</span> <span class="id" title="definition">polyC</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a><span class="id" title="notation">)</span>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">rewrite</span> {}<span class="id" title="var">p_Î¼2_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span>  <span class="id" title="var">Î¼s'</span> <span class="id" title="var">prop</span> <span class="id" title="var">size_Î¼s'</span> <span class="id" title="var">tÎ¼s'</span> <span class="id" title="var">tp</span> <span class="id" title="var">p_X2</span> <span class="id" title="var">p_Î¼2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> -&gt; : <span class="id" title="notation">(</span><span class="id" title="notation">(</span>-1<span class="id" title="notation">)</span> <span class="id" title="notation">^+</span> <span class="id" title="notation">(</span>1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)</span><span class="id" title="notation">)</span><span class="id" title="notation">)%:</span><span class="id" title="notation">P</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">(</span>-1<span class="id" title="notation">)</span> <span class="id" title="notation">^+</span> <span class="id" title="notation">(</span>1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)</span><span class="id" title="notation">)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> ((1 <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props.n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-</span> 1<span class="id" title="notation">)</span>)%<span class="id" title="var">N</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">nn</span> <span class="id" title="var">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="definition">signr_odd</span> -[<span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS"><span class="id" title="abbreviation">RHS</span></a>]<span class="id" title="definition">signr_odd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: (<span class="id" title="definition">odd</span> <span class="id" title="var">nn</span>) =&gt; //=; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="definition">expr0</span> ?<span class="id" title="definition">expr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">rmorphN1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">detZ</span> <span class="id" title="definition">scaleN1r</span> <span class="id" title="definition">opprB</span> <span class="id" title="definition">opprK</span>  /<span class="id" title="definition">char_poly</span> /<span class="id" title="definition">char_poly_mx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-<span class="id" title="lemma">det_mulmx</span>  <span class="id" title="lemma">mulmxDl</span> !<span class="id" title="lemma">mulmxDr</span>  -<span class="id" title="definition">rmorphN</span> //= -<span class="id" title="lemma">scalar_mxM</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#f_equal"><span class="id" title="lemma">f_equal</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> [<span class="id" title="tactic">in</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <a class="idref" href="Friendship.adj2_matrix.html#X:62"><span class="id" title="variable">X</span></a> <span class="id" title="notation">+</span> <span class="id" title="var">_</span>]<span class="id" title="definition">addrC</span>  <span class="id" title="definition">expr2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">in</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">_</span> <span class="id" title="notation">+</span> <span class="id" title="var">_</span> <span class="id" title="notation">+</span> <a class="idref" href="Friendship.adj2_matrix.html#X:63"><span class="id" title="variable">X</span></a>]<span class="id" title="definition">addrC</span> <span class="id" title="definition">addrA</span>  <span class="id" title="lemma">map_mxN</span> //=  <span class="id" title="lemma">comm_mx_scalar</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-[<span class="id" title="tactic">in</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <a class="idref" href="Friendship.adj2_matrix.html#X:64"><span class="id" title="variable">X</span></a> <span class="id" title="notation">+</span> <span class="id" title="notation">(</span><span class="id" title="notation">-</span> <span class="id" title="var">_</span> <span class="id" title="notation">*</span><span class="id" title="notation">m</span> <span class="id" title="var">_</span><span class="id" title="notation">)</span>]<span class="id" title="definition">addrA</span> -<span class="id" title="lemma">mulmxDr</span> <span class="id" title="definition">addrN</span> <span class="id" title="lemma">mulmx0</span> <span class="id" title="definition">addr0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#f_equal"><span class="id" title="lemma">f_equal</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">adj2_eq</span>  <span class="id" title="lemma">map_mx_is_multiplicative</span> //=  <span class="id" title="lemma">mulNmx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">p_Î¼2_eq</span> <span class="id" title="var">p_X2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> <span class="id" title="var">q</span> := <span class="id" title="definition">char_poly</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">p_Î¼2_q</span> : <span class="id" title="var">p_Î¼2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">q</span> <span class="id" title="notation">\</span><span class="id" title="notation">Po</span> <span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">^</span>2. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p_Î¼2_det</span> /<span class="id" title="var">q</span> /<span class="id" title="definition">char_poly</span> /<span class="id" title="definition">char_poly_mx</span>  -<span class="id" title="lemma">det_map_mx</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#f_equal"><span class="id" title="lemma">f_equal</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> [<span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS"><span class="id" title="abbreviation">RHS</span></a>]<span class="id" title="lemma">map_mxD</span> //= [<span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS"><span class="id" title="abbreviation">RHS</span></a>]<span class="id" title="lemma">map_scalar_mx</span>  //= <span class="id" title="lemma">comp_polyX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="definition">rmorphN</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">apply</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#f_equal"><span class="id" title="lemma">f_equal</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span> -&gt; : <span class="id" title="definition">map_mx</span> (<span class="id" title="definition">comp_poly</span> (<span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">^</span>2)) ( <span class="id" title="definition">map_mx</span> <span class="id" title="definition">polyC</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">map_mx</span> <span class="id" title="definition">polyC</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2"><span class="id" title="definition">adj2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> []. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span>  -<span class="id" title="lemma">map_mx_comp</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">matrixP</span> =&gt; <span class="id" title="var">i</span> <span class="id" title="var">j</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">mxE</span> //= <span class="id" title="lemma">comp_polyC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">aoeu</span> : <span class="id" title="var">q</span> <span class="id" title="notation">\</span><span class="id" title="notation">Po</span> <span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">^</span>2 <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">prod_</span><span class="id" title="notation">(</span><a id="ef463d5c1ccc97318a4547808dbcc645" class="idref" href="#ef463d5c1ccc97318a4547808dbcc645"><span class="id" title="binder">Î¼</span></a> <span class="id" title="notation">&lt;-</span> <span class="id" title="var">tÎ¼s'</span><span class="id" title="notation">)</span> <span class="id" title="notation">(</span><span class="id" title="notation">'</span><span class="id" title="notation">X</span><span class="id" title="notation">^</span>2 <span class="id" title="notation">-</span> <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#87340c6e2122162826d71b0019d0d3e1"><span class="id" title="variable">Î¼</span></a> <span class="id" title="notation">^</span> 2<span class="id" title="notation">)%:</span><span class="id" title="notation">P</span><span class="id" title="notation">)</span>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">p_Î¼2_q</span> /<span class="id" title="var">p_Î¼2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span> : <span class="id" title="keyword">forall</span> <a id="3b700ac6b049b495d52c4d5c3a1bba20" class="idref" href="#3b700ac6b049b495d52c4d5c3a1bba20"><span class="id" title="binder">Î¼</span></a>, <span class="id" title="notation">(</span><a class="idref" href="Friendship.adj2_matrix.html#3b700ac6b049b495d52c4d5c3a1bba20"><span class="id" title="variable">Î¼</span></a> <span class="id" title="notation">^</span> 2<span class="id" title="notation">)%:</span><span class="id" title="notation">P</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="Friendship.adj2_matrix.html#3b700ac6b049b495d52c4d5c3a1bba20"><span class="id" title="variable">Î¼</span></a><span class="id" title="notation">%:</span><span class="id" title="notation">P</span> <span class="id" title="notation">^</span> 2 <a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <span class="id" title="notation">{</span><span class="id" title="notation">poly</span> <span class="id" title="abbreviation">algC</span><span class="id" title="notation">}</span><a class="idref" href="http://coq.inria.fr/distrib/V8.15.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">hyp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">eq_bigr</span> =&gt; <span class="id" title="var">Î¼</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">hyp</span> <span class="id" title="var">Î¼</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">Î¼</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">exprSzr</span> !<span class="id" title="lemma">expr0z</span> !<span class="id" title="definition">mul1r</span>  <span class="id" title="lemma">polyC_multiplicative</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">Î¼s</span> <span class="id" title="var">prop2</span> <span class="id" title="var">prop3</span>] := (<a class="idref" href="Friendship.square_char_poly.html#polys_and_squares_technical_lemma"><span class="id" title="lemma">polys_and_squares_technical_lemma</span></a> <a class="idref" href="Friendship.adj2_matrix.html#lams_prod"><span class="id" title="lemma">lams_prod</span></a> <span class="id" title="var">aoeu</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">Î¼s</span>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">tp</span> <span class="id" title="var">prop2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;} {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">prop3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Friendship.adj2_matrix.html#adj2_matrix_props"><span class="id" title="section">adj2_matrix_props</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr">coqdoc</a> and improved with <a href="https://github.com/palmskog/coqdocjs">CoqdocJS</a> as adapted for <a href="https://github.com/coq-community">coq-community</a>
</div>
</div>
</body>

</html>
